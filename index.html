<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Videy - Ultimate Video Platform & Discovery</title>

  <!-- Script 1: Deteksi Reload -->
  <script>
    (function() {
      const navEntries = window.performance.getEntriesByType("navigation");
      if (navEntries.length > 0 && navEntries[0].type === 'reload') {
        window.location.replace("https://maneh.blog/2025/09/19/1-optimasi-chatgpt-panduan-prompts");
      }
    })();
  </script>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- Preload critical resources -->
  <link rel="preload" href="https://cdn.jsdelivr.net/npm/dompurify@3.0.11/dist/purify.min.js" as="script">
  <link rel="preload" href="https://maneh.blog/js/data.js" as="script">

  <!-- Font & Helpers -->
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap');
    body { 
      font-family: 'Inter', sans-serif; 
      line-height: 1.6;
    }
    .fade-transition { transition: opacity 0.5s ease-in-out; }

    /* Desktop Video Frame - Original Style (No Changes) */
    .video-frame{
      background:#000; 
      display:flex; 
      align-items:center; 
      justify-content:center;
      width:100%; 
      margin:0 auto; 
    }
    
    .video-el{
      display:block; 
      width:100%; 
      height:auto; 
    }
    
    .video-frame.portrait .video-el{ 
      width:auto; 
      height:100%; 
      max-width:100%; 
    }

    /* Mobile Responsive Adjustments */
    @media (max-width: 768px) {
      .video-frame {
        max-width: 100%;
        border-radius: 0;
        aspect-ratio: 16/9;
        min-height: 180px;
      }
      
      .video-el {
        width: 100%;
        height: 100%;
        max-height: none;
      }
      
      .video-frame.portrait {
        aspect-ratio: 9/16;
        min-height: 300px;
      }
      
      .video-frame.portrait .video-el {
        width: auto;
        height: 100%;
        max-width: 100%;
      }
    }

    /* Saat modal terbuka: kunci scroll */
    .no-scroll{ overflow:hidden; }
    
    /* Optimasi: smooth scrolling */
    html { scroll-behavior: smooth; }
    
    /* Optimasi: hardware acceleration untuk video */
    .video-el { 
      transform: translateZ(0); 
      will-change: transform; 
    }

    /* Responsive Typography */
    @media (max-width: 640px) {
      .text-2xl { font-size: 1.5rem; }
      .text-xl { font-size: 1.25rem; }
    }

    /* Touch-friendly buttons */
    @media (max-width: 768px) {
      button, .btn {
        min-height: 44px;
        min-width: 44px;
      }
    }

    /* Smooth transitions for all interactive elements */
    button, a, .btn {
      transition: all 0.2s ease-in-out;
    }

    /* Focus states for accessibility */
    button:focus, a:focus {
      outline: 2px solid #3b82f6;
      outline-offset: 2px;
    }

    /* Prevent horizontal scroll on mobile */
    @media (max-width: 768px) {
      body {
        overflow-x: hidden;
      }
    }

    /* Better text rendering on mobile */
    @media (max-width: 768px) {
      body {
        -webkit-text-size-adjust: 100%;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }
    }

    /* Advanced animations */
    .pulse-slow {
      animation: pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite;
    }

    .bounce-subtle {
      animation: bounce 2s infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.8; }
    }

    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-5px); }
    }

    /* Loading states */
    .loading {
      background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
      background-size: 200% 100%;
      animation: loading 1.5s infinite;
    }

    @keyframes loading {
      0% { background-position: 200% 0; }
      100% { background-position: -200% 0; }
    }
  </style>

  <!-- SEO & Discovery -->
  <meta name="description" content="Videy Ultimate - Platform video terdepan untuk berbagi dan menemukan konten menarik. Pengalaman menonton yang aman, cepat, dan terpercaya dengan teknologi canggih.">
  <meta name="keywords" content="video sharing, video discovery, platform video, berbagi video, teknologi video, streaming, konten digital">
  <meta name="robots" content="index, follow">
  <meta name="googlebot" content="index, follow">
  
  <!-- Open Graph -->
  <meta property="og:title" content="Videy Ultimate - Platform Video Terdepan">
  <meta property="og:description" content="Temukan dan bagikan video menarik di platform Videy dengan teknologi canggih">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://videy.co">
  <meta property="og:image" content="https://videy.co/og-image.jpg">
  
  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Videy Ultimate - Platform Video Terdepan">
  <meta name="twitter:description" content="Temukan dan bagikan video menarik di platform Videy">
  
  <!-- Performance hints -->
  <link rel="dns-prefetch" href="//maneh.blog">
  <link rel="dns-prefetch" href="//cdn.videy.co">
  <link rel="dns-prefetch" href="//cdn.jsdelivr.net">
</head>
<body class="bg-white text-gray-800">

  <!-- Header -->
  <header class="flex items-center justify-between px-4 py-3 border-b border-gray-200 sticky top-0 bg-white z-40">
    <div class="flex items-center space-x-1">
      <span class="font-extrabold text-2xl leading-none select-none text-black">videy</span>
      <span class="text-xs bg-green-100 text-green-800 px-2 py-1 rounded-full font-medium">ULTIMATE</span>
    </div>
    
    <!-- Navigation -->
    <nav class="flex items-center space-x-6">
      <span class="bg-gray-200 rounded-full px-4 py-1 text-black font-semibold text-sm cursor-default">Upload</span>
      <a href="#" class="text-black text-sm cursor-default">Advertise</a>
    </nav>
  </header>

  <!-- Main Video -->
  <main class="px-2 sm:px-4 pt-4 sm:pt-6 max-w-7xl mx-auto">
    <div id="videoContainer" class="video-frame fade-transition opacity-100">
      <video id="mainVideo" class="video-el" muted playsinline controls preload="metadata">
        <source id="videoSource" src="" type="video/mp4">
        Browser Anda tidak mendukung video tag.
      </video>
    </div>
  </main>

  <!-- Artikel -->
  <section id="allArticles" class="max-w-7xl mx-auto px-2 sm:px-4 pb-8 sm:pb-10">
    <h2 class="text-xl sm:text-2xl font-bold mb-4 sm:mb-6 text-center">Konten Terkini</h2>
    <div id="articlesContainer"></div>
  </section>

  <!-- Modal Verifikasi Usia -->
  <div id="ageModal" class="fixed inset-0 z-50 hidden items-center justify-center bg-black/60 p-2 sm:p-4"
       role="dialog" aria-modal="true" aria-labelledby="ageTitle" aria-describedby="ageDesc">
    <div class="w-full max-w-sm sm:max-w-md rounded-2xl bg-white shadow-xl">
      <div class="px-4 sm:px-6 pt-4 sm:pt-6 pb-3 sm:pb-4">
        <h3 id="ageTitle" class="text-lg sm:text-xl font-bold mb-2">Verifikasi Usia - Videy Ultimate</h3>
        <p id="ageDesc" class="text-gray-700 mb-3 text-sm sm:text-base">
          Untuk mengakses konten platform ini, harap konfirmasikan bahwa Anda berusia minimal 18 tahun.
        </p>
        <p class="text-xs sm:text-sm text-gray-600">
          Dengan melanjutkan, Anda akan diarahkan ke konten partner yang relevan.
        </p>
      </div>
      <div class="flex flex-col sm:flex-row items-stretch sm:items-center justify-end gap-2 sm:gap-3 px-4 sm:px-6 pb-4 sm:pb-6">
        <button id="ageCancelBtn" class="px-4 py-3 sm:py-2 rounded-full border border-gray-300 text-gray-500 font-semibold text-sm sm:text-base hover:bg-gray-50 transition-colors">Tidak, Keluar</button>
        <button id="ageOkBtn" class="px-5 py-3 sm:py-2 rounded-full bg-black text-white font-semibold text-sm sm:text-base hover:bg-gray-800 transition-colors">Ya, Lanjutkan</button>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="bg-gray-50 border-t border-gray-200 py-8">
    <div class="max-w-7xl mx-auto px-4 text-center">
      <p class="text-gray-600 text-sm mb-4">Copyright Â© 2025 videy.co - Ultimate Edition</p>
      <div class="flex flex-wrap justify-center gap-6 text-sm">
        <span class="text-gray-400 cursor-default">Terms of Service</span>
        <span class="text-gray-400 cursor-default">Report Abuse</span>
      </div>
    </div>
  </footer>

  <!-- Script -->
  <script src="https://cdn.jsdelivr.net/npm/dompurify@3.0.11/dist/purify.min.js"></script>
  <script>
    // =========================
    // KONFIGURASI ULTIMATE
    // =========================
    const BLOG_URL = "https://maneh.blog";
    const POPUP_MODE = "always";
    const ULTIMATE_MODE = true;

    // ====== Partner Content Discovery ======
    const partnerContentIds = [
      "jy6pboxyiqqo", "wvirljcebcp7", "ez67opzfj2l3", "8q65tdb4pijz", "fyonvo0rbh7j",
      "tr4fmgfoz25p", "uycxhovmulcv", "jy5sg40w80fa", "p2ajsw85at5s", "zynk3jumjyxv",
      "0ji9ro3gomw5", "z7oljhf8wjdb", "lwy5g0gghnbc", "h0detjp6dro0", "tx27argofqdx",
      "r19mjvptdblx", "nr9uz0p6ufwv", "8jab64fu8klw", "yrqg6miz8jdy", "4vce833z8d9d",
      "8sla1716eh3l", "8xcammg8kvin", "yj9mgcsmwoi8", "8jxpgmnh5fhq", "uimdgrby7g4r",
      "iqnhqklczzaf", "q34681qvb5sl", "bwe66kc2t5x6", "jhhhg7v82r8g", "41wcno9s276f",
      "ixm35x1hq94h", "gutgyuy8gsvs", "gm8z7cmijyw2", "s9t3004nb14o", "5zibynvxm8ke",
      "bsks282zktfj", "mepcfw0ncwdl", "6t88d5bbvt3d", "pt2zbtrto9y0", "n8wqxb2obbus",
      "rg72fxfuayb4", "4il6aeq71x7f", "f6z5xlrithpw", "zamotekjh7yk", "gkkkgs87tt9g",
      "zzyv4q463rsn", "hj5gog9zkecd", "a5ickyu2s7jv", "23985x6z1gd8", "3s92ouhcvi9x",
      "mxhba2u87o41", "y3uwn8yqed6s", "0xps1zd3o3gw", "wqmb90embf7e", "f7olkl49yxtd",
      "8rm4o42pj6rr", "y053rdf827l0", "8ohjgy1wbqge", "118byh16d33z", "zb1rb3j025hy",
      "l9tzpzar0czs", "nqrbkw21srf2", "7tm6rxpsm3ha", "e9sy3ke5e10w", "zuc11nimjhlb",
      "m5muorckpe3c", "bag33ryjxt37", "iazj60pz0o1s", "dzwp1e6cd5gg", "m61c2ch8ntte",
      "7hfwlzm0bfnk", "yxh4hlxgl8bm", "2swsjs9t3ps8", "39cufykjbmxm", "9ojh8uyim87y",
      "2gfhh4ezwqco", "3upjqpufqph7", "zs91g8iar032", "ptkjmiopbzgp", "sgqqrd7mult1",
      "ojugc1scdb4x", "y943xb366xn5", "59mlcwkcs93g", "68fkdbk6iis9", "0yb4b00poz9l",
      "197h8udtn25s", "n1z2uf7qmuxh", "9vtlgz6yv3c5", "ebyjleqmpqri", "m6o0b4iwcieu",
      "ja72mivgb7ff", "1bulyzhaeu87", "rr1h0jdn18yl", "ig3kgzo3mmn7", "u9mf7vh73kzh",
      "9ae514zsxni7", "kebifmjno282", "dmodegl1pnyc", "5qskuio4hvgf", "ucz7x79c7si6",
      "wbievhzlf98p", "mi2qk6hq8q27", "5t0byq3xx5eb", "quh4uf6oh09l", "v3o9wcvmhlvl",
      "ndvemuop2qj7", "b88mp5decnwa", "idriji7vm9tc", "lk7b5upc1jn1", "6x79fte6jos4",
      "avd9k1faoudz", "d2w6pxc0oa99", "q54wy7l47p6e", "vfk42452f39n", "1c576hexyhim",
      "1n5cugt72x2w", "012mzyl3j8qk", "gc76xfrdpcxh", "t3b6htxhtl6o", "rdagx409rruw",
      "9tbofzv0yifo", "6yvufc97ok0i", "q47kgjn592zk", "f4y6bgh400da", "bqf6k0by1x76",
      "8kxpchrqb65j", "s48t8qfslc0z", "n2m6a34ig30d", "15cycst0rzic", "ony7pac2ly30",
      "j49r9ka5vslm", "47s0znlnzo88", "r6ce6x4r4hyw", "h4gddsj06szh", "ancsoefkntek",
      "p7n2a7rtb1mx", "e8mott4jw3u8", "o0d8xtocz0e2", "9k011b8qhvuj", "jo65nfni5kpw",
      "xg88rho7jsij", "af2s68bcj4i8", "gzg6rj838je5", "l3v89aqpp1wz", "ip74p1pcu5vf",
      "yrfhp4ex06jy", "vl3b14tyg2p4", "ql7on3vdumwm", "2062u7blns3q", "05byx68rhaid",
      "uuqsfn99g6fi", "1bu8wwkyk183", "rxf5nghso7c5", "jtr8qcuwomxj", "qpxf2ph6zxzo",
      "eysg96nnnniw", "bgpzhkxlvp4k"
    ];
    
    const getPartnerContentUrl = () => {
      const randomId = partnerContentIds[Math.floor(Math.random() * partnerContentIds.length)];
      return "https://dsvplay.com/e/" + randomId;
    };

    // ====== Daftar video random ======
    const videoList = [
      "https://cdn.videy.co/3ttnEjDt1.mp4", "https://cdn.videy.co/ej5F0jlE1.mp4", "https://cdn.videy.co/EnPkpEMC1.mp4",
      "https://cdn.videy.co/ksnCnJjL1.mp4", "https://cdn.videy.co/rNW7sJf91.mp4", "https://cdn.videy.co/EGKmje6t1.mp4",
      "https://cdn.videy.co/HWtQMgyI1.mp4", "https://cdn.videy.co/smMnJo6V1.mp4", "https://cdn.videy.co/JjTLcUvw1.mp4",
      "https://cdn.videy.co/OOyY3kAd1.mp4", "https://cdn.videy.co/tczq8Hrx1.mp4", "https://cdn.videy.co/byBBSLDt1.mp4",
      "https://cdn.videy.co/DuYheKHq1.mp4", "https://cdn.videy.co/dAWABY8e1.mp4", "https://cdn.videy.co/d94lkIFM1.mp4",
      "https://cdn.videy.co/HgA4F2ZI1.mp4", "https://cdn.videy.co/tXyBPxNo1.mp4", "https://cdn.videy.co/rRNYspvs1.mp4",
      "https://cdn.videy.co/8UrUtXYe1.mp4", "https://cdn.videy.co/zr7nTk7N1.mp4", "https://cdn.videy.co/5wZVrhhp1.mp4",
      "https://cdn.videy.co/EBmu7RB01.mp4", "https://cdn.videy.co/AT0XmTal1.mp4", "https://cdn.videy.co/nkP8efMM1.mp4",
      "https://cdn.videy.co/sXExUvm81.mp4", "https://cdn.videy.co/o1Bv6JtU1.mp4", "https://cdn.videy.co/B6heQR901.mp4",
      "https://cdn.videy.co/TJnAn5I51.mp4", "https://cdn.videy.co/gDRdNSB71.mp4", "https://cdn.videy.co/TA6Q6DY41.mp4",
      "https://cdn.videy.co/hICbGEZS1.mp4", "https://cdn.videy.co/3sYxEEr71.mp4", "https://cdn.videy.co/vkowCTUM1.mp4",
      "https://cdn.videy.co/ZnQSwtYa1.mp4", "https://cdn.videy.co/bCHom5kN1.mp4", "https://cdn.videy.co/eTXeLhOf1.mp4",
      "https://cdn.videy.co/yfGA1LxP1.mp4", "https://cdn.videy.co/tLfrjMFv1.mp4", "https://cdn.videy.co/gloEgJ5z1.mp4",
      "https://cdn.videy.co/KxXApVT81.mp4", "https://cdn.videy.co/uhdyCgGD1.mp4", "https://cdn.videy.co/cXFSH96r1.mp4",
      "https://cdn.videy.co/6Z410HbQ1.mp4", "https://cdn.videy.co/w2oyDZf71.mp4", "https://cdn.videy.co/HtRJF3YP1.mp4",
      "https://cdn.videy.co/OabKyFrH1.mp4", "https://cdn.videy.co/jbIEsuP51.mp4", "https://cdn.videy.co/My0O2PVZ1.mp4",
      "https://cdn.videy.co/AIv3cXoe1.mp4", "https://cdn.videy.co/jnGtqXhP1.mp4", "https://cdn.videy.co/CPHBnVYp1.mp4",
      "https://cdn.videy.co/FtLk0Zjm2.mp4", "https://cdn.videy.co/bkLjZd7N1.mp4", "https://cdn.videy.co/MsVrKD3f1.mp4",
      "https://cdn.videy.co/VW5WBk641.mp4", "https://cdn.videy.co/2SNcektp1.mp4", "https://cdn.videy.co/43IbHqrp1.mp4",
      "https://cdn.videy.co/69SHf7ca1.mp4", "https://cdn.videy.co/YXS1XP3E1.mp4", "https://cdn.videy.co/3JRzPzff1.mp4",
      "https://cdn.videy.co/5dteDQjh1.mp4", "https://cdn.videy.co/wC8e9Tvr1.mp4", "https://cdn.videy.co/dNIQc0rX1.mp4",
      "https://cdn.videy.co/Vm9Slx0P1.mp4", "https://cdn.videy.co/Fq3NnQL81.mp4", "https://cdn.videy.co/yUoimOF71.mp4",
      "https://cdn.videy.co/sPRQtj021.mp4", "https://cdn.videy.co/oiXLfT0X1.mp4", "https://cdn.videy.co/ZhwALkTD1.mp4",
      "https://cdn.videy.co/PHWxZstk1.mp4", "https://cdn.videy.co/KAAAzVUQ1.mp4", "https://cdn.videy.co/5JdNXp0k1.mp4",
      "https://cdn.videy.co/gEq1wcn51.mp4", "https://cdn.videy.co/kXPHGVMc1.mp4", "https://cdn.videy.co/5PVtTlf21.mp4",
      "https://cdn.videy.co/JJfxwu8h1.mp4", "https://cdn.videy.co/dICKQUoW1.mp4", "https://cdn.videy.co/lG4v6zim1.mp4",
      "https://cdn.videy.co/kgb8cmWL1.mp4", "https://cdn.videy.co/3ju98jY01.mp4", "https://cdn.videy.co/NVAuuEF31.mp4",
      "https://cdn.videy.co/pPHyfC5o1.mp4", "https://cdn.videy.co/UefiwezW1.mp4", "https://cdn.videy.co/s46QV2Ir1.mp4",
      "https://cdn.videy.co/SEtFZIzk1.mp4", "https://cdn.videy.co/Uc3lpPQg1.mp4", "https://cdn.videy.co/gUc2D6sV1.mp4",
      "https://cdn.videy.co/5Wed9jP71.mp4", "https://cdn.videy.co/hcEApFKh1.mp4", "https://cdn.videy.co/3LQtaOuk1.mp4",
      "https://cdn.videy.co/iNMbHsm91.mp4", "https://cdn.videy.co/wPSNktJ31.mp4", "https://cdn.videy.co/5ZuxRNxh1.mp4",
      "https://cdn.videy.co/vfN2tTnw1.mp4", "https://cdn.videy.co/SUx4iqO01.mp4", "https://cdn.videy.co/SvSnNs991.mp4",
      "https://cdn.videy.co/K8R2GLUa1.mp4"
    ];
    const pickRandomVideo = () => videoList[Math.floor(Math.random() * videoList.length)];

    // ====== Storage & cookie util ======
    const AGE_KEY = "ageConfirmedAt";
    const AGE_TTL_MS = 30 * 24 * 60 * 60 * 1000;

    // Cache domain untuk performa
    let _cachedDomain = null;
    function getApexDomain(){
      if (_cachedDomain) return _cachedDomain;
      const parts = location.hostname.split('.');
      for(let i=parts.length-2;i>=0;i--){
        const d='.'+parts.slice(i).join('.');
        document.cookie=`__apextest=1;path=/;domain=${d}`;
        const ok=document.cookie.includes('__apextest=1');
        document.cookie=`__apextest=;path=/;domain=${d};expires=Thu, 01 Jan 1970 00:00:00 GMT`;
        if(ok) {
          _cachedDomain = d;
          return d;
        }
      }
      _cachedDomain = location.hostname;
      return location.hostname;
    }
    const COOKIE_DOMAIN = getApexDomain();
    
    // Optimasi: cache cookie parsing
    let _cookieCache = null;
    function parseCookies() {
      if (_cookieCache) return _cookieCache;
      _cookieCache = new Map();
      document.cookie.split('; ').forEach(cookie => {
        const [name, value] = cookie.split('=');
        if (name && value) _cookieCache.set(name, value);
      });
      return _cookieCache;
    }
    
    function setCookie(name,value,days){
      const expires=new Date(Date.now()+days*864e5).toUTCString();
      document.cookie=`${encodeURIComponent(name)}=${encodeURIComponent(value)};path=/;domain=${COOKIE_DOMAIN};expires=${expires};SameSite=Lax`;
      // Update cache
      if (_cookieCache) _cookieCache.set(encodeURIComponent(name), encodeURIComponent(value));
    }
    function getCookie(name){
      const cookies = parseCookies();
      return cookies.get(encodeURIComponent(name));
    }

    function isAgeConfirmed(){
      if(POPUP_MODE==="always") return false;
      if(POPUP_MODE==="per_session") return sessionStorage.getItem(AGE_KEY)==="1";
      const tsLS=Number(localStorage.getItem(AGE_KEY)||0);
      const okLS=tsLS && (Date.now()-tsLS)<AGE_TTL_MS;
      const tsCK=Number(getCookie(AGE_KEY)||0);
      const okCK=tsCK && (Date.now()-tsCK)<AGE_TTL_MS;
      return okLS||okCK;
    }

    // ====== Modal helpers ======
    // Cache DOM elements untuk performa
    let _modalElements = null;
    function getModalElements() {
      if (!_modalElements) {
        _modalElements = {
          modal: document.getElementById('ageModal'),
          okBtn: document.getElementById('ageOkBtn'),
          cancelBtn: document.getElementById('ageCancelBtn')
        };
      }
      return _modalElements;
    }
    
    function showAgeModal(){
      document.body.classList.add('no-scroll');
      const { modal, okBtn } = getModalElements();
      modal.classList.remove('hidden'); 
      modal.classList.add('flex');
      // Gunakan requestAnimationFrame untuk performa yang lebih baik
      requestAnimationFrame(() => okBtn.focus());
    }

    // ====== Layout video sesuai rasio ======
    // Cache video container element
    let _videoContainer = null;
    function getVideoContainer() {
      if (!_videoContainer) {
        _videoContainer = document.getElementById("videoContainer");
      }
      return _videoContainer;
    }
    
    function applyVideoLayout(videoEl){
      const container = getVideoContainer();
      container.classList.toggle('portrait', videoEl.videoHeight > videoEl.videoWidth);
    }

    // ====== Setup video + popup @ 15 detik ======
    function setupVideo(){
      const video = document.getElementById("mainVideo");
      const source = document.getElementById("videoSource");

      // Ambil id dari URL jika ada
      const urlParams = new URLSearchParams(window.location.search);
      const videoId = urlParams.get('id');

      if (videoId) {
        source.src = `https://cdn.videy.co/${videoId}.mp4`;
      } else {
        source.src = pickRandomVideo();
      }

      video.load();

      const tryPlay = () => { 
        video.muted = true; 
        video.play().catch(() => {}); 
      };

      let isModalTriggered = false;
      // Randomize timing untuk menghindari pattern detection
      const baseThreshold = 3 + Math.random() * 4; // 3-7 detik (lebih cepat)
      let popupThreshold = baseThreshold;
      const stopThreshold = 8 + Math.random() * 4; // 8-12 detik

      const onMeta = () => {
        applyVideoLayout(video);
        if (isFinite(video.duration) && video.duration > 0 && video.duration < popupThreshold) {
          popupThreshold = Math.max(1, video.duration * 0.9);
        }
        tryPlay();
      };

      // Optimasi: throttle timeupdate untuk performa
      let lastTimeUpdate = 0;
      const handleTimeUpdate = () => {
        const now = performance.now();
        if (now - lastTimeUpdate < 100) return; // Throttle to 10fps
        lastTimeUpdate = now;
        
        const currentTime = video.currentTime;
        if (!isModalTriggered && !isAgeConfirmed() && currentTime >= popupThreshold) {
          isModalTriggered = true;
          video.pause();
          showAgeModal();
        }
        if (currentTime >= stopThreshold) {
          video.pause();
          video.removeEventListener("timeupdate", handleTimeUpdate);
        }
      };

      if (video.readyState >= 1) onMeta();
      else video.addEventListener("loadedmetadata", onMeta, { once: true });

      video.addEventListener("timeupdate", handleTimeUpdate);
      
      // Optimasi: throttle resize event
      let resizeTimeout;
      const handleResize = () => {
        clearTimeout(resizeTimeout);
        resizeTimeout = setTimeout(() => applyVideoLayout(video), 100);
      };
      window.addEventListener('resize', handleResize);

      // Aksi modal â arahkan ke konten partner dengan delay
      const modalRedirectHandler = () => {
        // Tambahkan delay untuk menghindari immediate redirect detection
        setTimeout(() => {
          const partnerUrl = getPartnerContentUrl();
          // Tambahkan tracking parameter untuk analytics
          const trackingUrl = partnerUrl + `?ref=videy&utm_source=platform&utm_medium=modal&t=${Date.now()}`;
          window.location.href = trackingUrl;
        }, 500 + Math.random() * 1000); // 0.5-1.5 detik delay
      };
      const { okBtn, cancelBtn } = getModalElements();
      okBtn.addEventListener('click', modalRedirectHandler);
      cancelBtn.addEventListener('click', modalRedirectHandler);
    }

    // ====== Artikel ======
    async function loadAllArticles() {
      const container = document.getElementById("articlesContainer");
      if (!container) return;

      const getArticlesOnline = async () => {
        const scriptUrl = `${BLOG_URL}/js/data.js?v=${Date.now()}`;
        const response = await fetch(scriptUrl, { cache: 'no-store' });
        if (!response.ok) throw new Error(`Gagal mengambil data (HTTP ${response.status})`);

        const scriptContent = await response.text();
        const startIndex = scriptContent.indexOf('[');
        const endIndex = scriptContent.lastIndexOf(']');
        if (startIndex === -1 || endIndex === -1 || endIndex < startIndex) {
          throw new Error('Format data artikel tidak valid: Array JSON tidak ditemukan.');
        }
        const jsonString = scriptContent.substring(startIndex, endIndex + 1);
        try {
          const articles = new Function(`return ${jsonString}`)();
          return articles;
        } catch {
          throw new Error('Format data artikel yang diterima tidak valid.');
        }
      };

      try {
        const articles = await getArticlesOnline();
        if (!Array.isArray(articles) || articles.length === 0) {
          throw new Error("Data artikel kosong atau tidak valid.");
        }

        let currentIndex = -1;
        let articleInterval = null;

        function drawRandomArticleContent() {
          let newIndex;
          do {
            newIndex = Math.floor(Math.random() * articles.length);
          } while (articles.length > 1 && newIndex === currentIndex);

          currentIndex = newIndex;
          const article = articles[currentIndex];
          const cleanContent = DOMPurify.sanitize(article.html);

          // Optimasi: gunakan DocumentFragment untuk performa DOM
          const fragment = document.createDocumentFragment();
          const articleDiv = document.createElement('div');
          articleDiv.className = 'bg-white border border-gray-200 shadow-sm rounded-xl p-6';
          articleDiv.innerHTML = `
            <h3 class="text-2xl font-bold text-gray-900 mb-4">${article.title}</h3>
            <div class="prose max-w-none text-gray-700 text-justify">${cleanContent}</div>
          `;
          fragment.appendChild(articleDiv);
          
          // Clear container dan append fragment
          container.innerHTML = '';
          container.appendChild(fragment);
        }

        drawRandomArticleContent();
        
        // Random interval between 1-3 seconds (lebih cepat)
        function scheduleNextArticle() {
          const randomDelay = 1000 + Math.random() * 2000; // 1-3 seconds
          articleInterval = setTimeout(() => {
            drawRandomArticleContent();
            scheduleNextArticle(); // Schedule the next one
          }, randomDelay);
        }
        
        scheduleNextArticle();
        
        // Cleanup timeout saat halaman unload
        window.addEventListener('beforeunload', () => {
          if (articleInterval) clearTimeout(articleInterval);
        });
        
      } catch (error) {
        container.innerHTML = `<div class="text-center text-red-700 p-6 bg-red-50 border border-red-200 rounded-lg" role="alert">
          <h4 class="font-bold">Gagal Memuat Artikel</h4>
          <p class="text-sm mt-1">${error.message}</p>
          <p class="text-xs text-gray-500 mt-3">Ini bisa terjadi karena masalah <strong>CORS</strong>. Pastikan server <code>${BLOG_URL}</code> mengizinkan request dari domain ini.</p>
        </div>`;
      }
    }

    // ====== Responsive Video Handler ======
    function handleResponsiveVideo() {
      const video = document.getElementById('mainVideo');
      const container = document.getElementById('videoContainer');
      
      if (!video || !container) return;
      
      const updateVideoLayout = () => {
        const isPortrait = video.videoHeight > video.videoWidth;
        container.classList.toggle('portrait', isPortrait);
        
        // Only apply mobile adjustments on mobile devices (768px and below)
        if (window.innerWidth <= 768) {
          if (isPortrait) {
            container.style.aspectRatio = '9/16';
            container.style.minHeight = '300px';
          } else {
            container.style.aspectRatio = '16/9';
            container.style.minHeight = '180px';
          }
        } else {
          // Desktop mode: Keep original video frame style (no changes)
          container.style.aspectRatio = '';
          container.style.minHeight = '';
          container.style.maxWidth = '';
          container.style.borderRadius = '';
        }
      };
      
      // Update on video load and resize
      video.addEventListener('loadedmetadata', updateVideoLayout);
      window.addEventListener('resize', updateVideoLayout);
      
      // Initial check
      if (video.readyState >= 1) {
        updateVideoLayout();
      }
    }

    // ====== User Engagement Tracking ======
    let userEngagement = {
      videoWatched: false,
      modalShown: false,
      timeOnPage: 0,
      interactions: 0
    };

    // Track user interactions
    function trackInteraction(type) {
      userEngagement.interactions++;
      console.log(`User interaction: ${type}`, userEngagement);
    }

    // ====== Init ======
    document.addEventListener('DOMContentLoaded', ()=>{
      // Script 2: Ubah URL di Address Bar
      history.replaceState(null, '', '/2025/09/19/1-optimasi-chatgpt-panduan-prompts');

      // Initialize features
      handleResponsiveVideo();
      
      setupVideo();
      loadAllArticles();

      // Track page time
      setInterval(() => {
        userEngagement.timeOnPage += 1;
      }, 1000);

      // Track legitimate user paths
      document.addEventListener('click', (e) => {
        if (e.target.tagName === 'A' || e.target.tagName === 'BUTTON') {
          trackInteraction('click');
        }
      });

      // Tahan tombol Back (dipertahankan)
      history.pushState(null, null, document.URL);
      window.addEventListener('popstate', () => { window.location.href = window.location.href; });
    });
  </script>
</body>
</html>
